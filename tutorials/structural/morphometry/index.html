<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Types of Morphometry Analyses &mdash; Brain Imaging and Behavior Lab</title>
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/assets/main.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/images/logo.png"/>
    <link href="/feed.xml" rel="alternate" type="application/rss+xml" title="Brain Imaging and Behavior Lab" />
    <meta name="title" content="Types of Morphometry Analyses ">
    <link rel="canonical" href="http://biabl.github.io/tutorials/structural/morphometry/">
     
           
    <meta property="og:title" content="Types of Morphometry Analyses "/>
    <meta property="og:url" content="http://biabl.github.io/tutorials/structural/morphometry/"/>
    
    
    <meta property="og:site_name" content="Brain Imaging and Behavior Lab">     
</head>
<body>
    <section class="site-nav">
        <header>
            <nav id="navigation">
                <a class="brand" href="/"><img alt="Inc" src="/images/logo.png"></a> 
                <a class="home" href="/">Blog</a>
                <a class="home" href="/tags/">Tags</a>
				<li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
                    <ul class="dropdown-menu multi-level">
                        <li class="dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">General Topics</a>
                            <ul class="dropdown-menu">
                                <li><a href="/tutorials/general/unix-cheat-sheet/">Unix Cheat Sheet</a></li>
                				<li><a href="/tutorials/general/introduction-to-fulton-supercomputer-lab/">Introduction to Fulton Supercomputer</a></li>
                				<li><a href="/tutorials/general/submitting_jobs/">Submitting Batch Jobs on Supercomputer</a></li>
                				<li><a href="/tutorials/general/R/">Learn R</a></li>
                				<li><a href="/tutorials/general/install-freesurfer/">How to Install Freesurfer on Supercomputer</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Structural Imaging Topics</a>
                            <ul class="dropdown-menu">
                                <li><a href="/tutorials/structural/preprocessing_T1_weighted_images/">Preprocessing T1 Weighted Images</a></li>
                				<li><a href="/tutorials/structural/convert-to-nifti/">Other Ways to Convert to NIfTI</a></li>
                				<li><a href="/tutorials/structural/normalization/">Normalization</a></li>
                				<li><a href="/tutorials/structural/cortical_thickness/">Tissue Segmentation and Cortical Thickness</a></li>
                				<li><a href="/tutorials/structural/morphometry/">Various Morphometry Analyses</a></li>
                				<li><a href="/tutorials/structural/ANTsR/">ANTsR</a></li>
                				<li><a href="/tutorials/structural/group_average/">Group Average Overlays with ANTsR</a></li>
                				<li><a href="/tutorials/structural/roi/">ROI Analysis with DKT</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Diffusion Imaging Topics</a>
                            <ul class="dropdown-menu">
                                <li><a href="/tutorials/diffusion/preprocessing_diffusion_weighted_images/">Preprocessing Diffusion Weighted Images</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Projects<b class="caret"></b></a>
                    <ul class="dropdown-menu multi-level">
                        <li class="dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">MIOS</a>
                            <ul class="dropdown-menu">
                                <li><a href="/projects/MIOS/corpus-callosum/">Corpus Callosum</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </nav>
        </header>
    </section>
    
<article>

    <div class="container">
        <header>
        	
            <div class="meta">
                By <address><a rel="author" href="" title="Naomi J. Goodrich-Hunsaker" target="_blank">Naomi J. Goodrich-Hunsaker</a></address> &mdash;
                <time pubdate datetime="2015-09-December" title="December 09, 2015">December 09, 2015</time>
            </div>
            <h1 class="title">Types of Morphometry Analyses</h1>
            
        </header>

        <section>
            <h2 id="objectives">Objectives</h2>

<p>After you complete this section, you should be able to:</p>

<ol>
  <li>Describe tensor based morphometry</li>
  <li>Know what image is used in TBM</li>
  <li>Describe voxel based morphometry</li>
  <li>Know how to generate the image used in VBM</li>
</ol>

<p>Note that everything in “&lt; &gt;” is to be replaced. For example, &lt;fileName&gt; –&gt; iLovePeanuts.txt</p>

<h2 id="tensor-based-morphometry">Tensor Based Morphometry</h2>

<p>Tensor based morphometry measures the differences in shape of brain structures. Analyses are useful in studies interested in whether growth or volume loss has occurred. This analysis is also useful in detecting small changes in longitudinal studies.</p>

<p>The warp field only represents positions of brain structures and not local shape information. Instead, the Jacobian determinant contains information about the local stretching, shearing and rotation involved in the deformation.</p>

<h3 id="fixed-image">Fixed Image</h3>

<figure class="half">
	<img alt="" src="images/fixed.jpg" />
	<img alt="" src="images/moving.jpg" />
	
</figure>

<figure>
	<img alt="" src="images/logjac.png" />
	
</figure>

<p>Taking the log of the Jacobian makes it symmetric about zero. Positive values indicate tissue enlargement, whereas negative values indicate tissue reduction in the participant as compared to the template.</p>

<h3 id="group-analysis">Group Analysis</h3>

<p>In order to complete group analyses, all images have to be template space so you know you are comparing apples to apples. For group analyses, images cannot be in native, participant space.</p>

<p>The log Jacobian image is used for analyses. Running antsCorticalThickness pipeline will automatically generate the log Jacobian (i.e., <em>SubjectToTemplateLogJacobian.nii.gz</em>).</p>

<h2 id="voxel-based-morphometry">Voxel Based Morphometry</h2>

<p>Voxel Based Morphometry measures structural differences in tissue classes (e.g., gray matter atrophy). Analyses are useful in studies interested in tissue specific volumetric differences.</p>

<p>The normalized images are adjusted by scaling the intensity of each voxel by the log jacobian. In other words the volume changes due to the non-linear spatial normalization are used to <em>modulate</em> the normalized image. Otherwise your analysis will give you null results because all the images look exactly alike (that’s the point of normalizing to a template).</p>

<figure>
	<img alt="" src="images/workflow.png" />
	
</figure>

<h3 id="group-analysis-1">Group Analysis</h3>

<p>The modulated normalized gray matter image is used for analyses. This image has to be self generated.</p>

<h2 id="modulate-gray-matter-image">Modulate Gray Matter Image</h2>

<p>First, you will take the template GM ROI and multiply it with the normalization whole brain image. Remember the value inside the ROI is 1 and the value outside the ROI is 0. When you multiply anything by 0 it equals 0, so when you multiply these two images together, you are left with just normalized gray matter.</p>

<figure class="half">
	<img alt="" src="images/brain.png" />
	<img alt="" src="images/roi.png" />
	
</figure>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">SUBJ_DIR</span><span class="o">=</span>~/path/to/subject/directory
<span class="nv">TEMPLATE_DIR</span><span class="o">=</span>~/path/to/template/directory/
c3d <span class="se">\</span>
<span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/BrainNormalizedToTemplate.nii.gz <span class="se">\</span>
<span class="k">${</span><span class="nv">TEMPLATE_DIR</span><span class="k">}</span>/T_template0_gm.nii.gz <span class="se">\</span>
-multiply <span class="se">\</span>
-o <span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/GMSegmented.nii.gz</code></pre></div>

<figure>
	<img alt="" src="images/segmented.png" />
	
</figure>

<p>The image has been normalized to a template, so at this point the image should be nearly indistinguishable from the template. Any comparison will result in null results. However, if you multiply the image by the log Jacobian, then you are adjusting the intensity of each gray matter voxel by the amount of stretching, shearing, and rotation that occurred.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">c3d <span class="se">\</span>
<span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/GMSegmented.nii.gz <span class="se">\</span>
<span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/SubjectToTemplateLogJacobian.nii.gz <span class="se">\</span>
-multiply <span class="se">\</span>
-o <span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/GMModulated.nii.gz</code></pre></div>

<figure>
	<img alt="" src="images/modulated.png" />
	
</figure>

<h3 id="additional-classroom-materials">Additional Classroom Materials</h3>

<ul>
  <li><a href="presentation">Lecture</a></li>
  <li><a href="assignment">Assignment</a></li>
</ul>

            
        </section>

        <footer>
            <address>
               <img src="/images/naomi.jpg">
                <p>Written by <strong><a rel="author" href="https://twitter.com/" title="" target="_blank">Naomi J. Goodrich-Hunsaker</a></strong><br>
                <span class="muted">Website Manager</span>
                </p>
            </address>

        </footer>

        
        <section>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'biabl'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
        </section>
        
    </div>
</article>

    <footer class="site-footer">
        <div class="container">
            &copy; 2015
            <nav>
                <a href="http://biabl.github.io">Brain Imaging and Behavior Lab</a>
            </nav>
            <nav class="social">
                 
                 
                <a href="/feed.xml" title="RSS Feed"><i class="icon icon-rss black"></i></a>
            </nav>
        </div>
    </footer>
    
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js" defer></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" defer></script>
  <script src="dist/js/bootstrap-submenu.min.js" defer></script>
  <style type="text/css">
<script src="/assets/main.js"></script>







</body>
</html>