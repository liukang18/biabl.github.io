<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to Install FreeSurfer on Supercomputer &mdash; Brain Imaging and Behavior Lab</title>
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/assets/main.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/images/logo.png"/>
    <link href="/feed.xml" rel="alternate" type="application/rss+xml" title="Brain Imaging and Behavior Lab" />
    <meta name="title" content="How to Install FreeSurfer on Supercomputer ">
    <link rel="canonical" href="http://biabl.github.io/tutorials/general/install-freesurfer/">
     
           
    <meta property="og:title" content="How to Install FreeSurfer on Supercomputer "/>
    <meta property="og:url" content="http://biabl.github.io/tutorials/general/install-freesurfer/"/>
    
    
    <meta property="og:site_name" content="Brain Imaging and Behavior Lab">     
</head>
<body>
    <section class="site-nav">
        <header>
            <nav id="navigation">
                <a class="brand" href="/"><img alt="Inc" src="/images/logo.png"></a> 
                <a class="home" href="/">Blog</a>
                <a class="home" href="/tags/">Tags</a>
				<li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
                    <ul class="dropdown-menu multi-level">
                        <li class="dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">General Topics</a>
                            <ul class="dropdown-menu">
                                <li><a href="/tutorials/general/unix-cheat-sheet/">Unix Cheat Sheet</a></li>
                				<li><a href="/tutorials/general/introduction-to-fulton-supercomputer-lab/">Introduction to Fulton Supercomputer</a></li>
                				<li><a href="/tutorials/general/submitting_jobs/">Submitting Batch Jobs on Supercomputer</a></li>
                				<li><a href="/tutorials/general/R/">Learn R</a></li>
                				<li><a href="/tutorials/general/install-freesurfer/">How to Install Freesurfer on Supercomputer</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Structural Imaging Topics</a>
                            <ul class="dropdown-menu">
                                <li><a href="/tutorials/structural/preprocessing_T1_weighted_images/">Preprocessing T1 Weighted Images</a></li>
                				<li><a href="/tutorials/structural/convert-to-nifti/">Other Ways to Convert to NIfTI</a></li>
                				<li><a href="/tutorials/structural/normalization/">Normalization</a></li>
                				<li><a href="/tutorials/structural/cortical_thickness/">Tissue Segmentation and Cortical Thickness</a></li>
                				<li><a href="/tutorials/structural/morphometry/">Various Morphometry Analyses</a></li>
                				<li><a href="/tutorials/structural/ANTsR/">ANTsR</a></li>
                				<li><a href="/tutorials/structural/group_average/">Group Average Overlays with ANTsR</a></li>
                				<li><a href="/tutorials/structural/roi/">ROI Analysis with DKT</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Diffusion Imaging Topics</a>
                            <ul class="dropdown-menu">
                                <li><a href="/tutorials/diffusion/preprocessing_diffusion_weighted_images/">Preprocessing Diffusion Weighted Images</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Projects<b class="caret"></b></a>
                    <ul class="dropdown-menu multi-level">
                        <li class="dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">MIOS</a>
                            <ul class="dropdown-menu">
                                <li><a href="/projects/MIOS/corpus-callosum/">Corpus Callosum</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </nav>
        </header>
    </section>
    
<article>

    <div class="container">
        <header>
        	
            <div class="meta">
                By <address><a rel="author" href="" title="Naomi J. Goodrich-Hunsaker" target="_blank">Naomi J. Goodrich-Hunsaker</a></address> &mdash;
                <time pubdate datetime="2015-09-December" title="December 09, 2015">December 09, 2015</time>
            </div>
            <h1 class="title">How to Install FreeSurfer on Supercomputer</h1>
            
        </header>

        <section>
            <h2 id="lets-do-this-thing">Letâ€™s Do This Thing!</h2>

<p>For students needing to use FreeSurfer, log into the supercomputer:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">ssh &lt;username&gt;@ssh.fsl.byu.edu</code></pre></div>

<p>Go to your apps directory:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> ~/apps/</code></pre></div>

<p>Download the latest version of FreeSurfer:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">wget ftp://surfer.nmr.mgh.harvard.edu/pub/dist/freesurfer/5.3.0/freesurfer-Linux-centos6_x86_64-stable-pub-v5.3.0.tar.gz</code></pre></div>

<p>Unzip the compressed tar:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">tar -xzvf freesurfer-Linux-centos6_x86_64-stable-pub-v5.3.0.tar.gz</code></pre></div>

<p>Set the path to your FreeSurfer directory:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">echo</span> <span class="s2">&quot;export FREESURFER_HOME=/fslhome/username/apps/freesurfer&quot;</span> &gt;&gt; ~/.bash_profile</code></pre></div>

<p>You will need to register for a license at:</p>

<p><a href="https://surfer.nmr.mgh.harvard.edu/registration.html">https://surfer.nmr.mgh.harvard.edu/registration.html</a></p>

<p>Once you receive your license information, you will need to create a text file in your FreeSurfer directory:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">vi ~/apps/freesurfer/license.txt</code></pre></div>

<p>Enter insert mode (type <code>a</code>) then copy and paste the license information into the text file. To save hit <code>ESC</code> then type <code>:wq</code> and hit <code>RETURN</code>.</p>

<p>To check to make sure the program works:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">source</span> ~/.bash_profile
~/apps/freesurfer/bin/recon-all</code></pre></div>

<p>And you should see this output:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">Required Arguments:
   -subjid &lt;subjid&gt;
   -&lt;process directive&gt;

 Fully-Automated Directive:
  -all           : performs all stages of cortical reconstruction
  -autorecon-all : same as -all

 Manual-Intervention Workflow Directives:
  -autorecon1    : process stages 1-5 <span class="o">(</span>see below<span class="o">)</span>
  -autorecon2    : process stages 6-23
                   after autorecon2, check white surfaces:
                     a. <span class="k">if</span> wm edit was required, <span class="k">then</span> run -autorecon2-wm
                     b. <span class="k">if</span> control points added, <span class="k">then</span> run -autorecon2-cp
                     c. proceed to run -autorecon3
  -autorecon2-cp : process stages 12-23 <span class="o">(</span>uses -f w/ mri_normalize, -keep w/ mri_seg<span class="o">)</span>
  -autorecon2-wm : process stages 15-23
  -autorecon2-inflate1 : 6-18
  -autorecon2-perhemi : tess, sm1, inf1, q, fix, sm2, inf2, finalsurf, ribbon
  -autorecon3    : process stages 24-34
                     <span class="k">if</span> edits made to correct pial, <span class="k">then</span> run -autorecon-pial
  -hemi ?h       : just <span class="k">do</span> lh or rh <span class="o">(</span>default is to <span class="k">do</span> both<span class="o">)</span>

  Autorecon Processing Stages <span class="o">(</span>see -autorecon# flags above<span class="o">)</span>:
    1.  Motion Correction and Conform
    2.  NU <span class="o">(</span>Non-Uniform intensity normalization<span class="o">)</span>
    3.  Talairach transform computation
    4.  Intensity Normalization 1
    5.  Skull Strip

    6.  EM Register <span class="o">(</span>linear volumetric registration<span class="o">)</span>
    7.  CA Intensity Normalization
    8.  CA Non-linear Volumetric Registration
    9.  Remove neck
    10. EM Register, with skull
    11. CA Label <span class="o">(</span>Aseg: Volumetric Labeling<span class="o">)</span> and Statistics

    12. Intensity Normalization <span class="m">2</span> <span class="o">(</span>start here <span class="k">for</span> control points<span class="o">)</span>
    13. White matter segmentation
    14. Edit WM With ASeg
    15. Fill <span class="o">(</span>start here <span class="k">for</span> wm edits<span class="o">)</span>
    16. Tessellation <span class="o">(</span>begins per-hemisphere operations<span class="o">)</span>
    17. Smooth1
    18. Inflate1
    19. QSphere
    20. Automatic Topology Fixer
    21. White Surfs <span class="o">(</span>start here <span class="k">for</span> brain edits <span class="k">for</span> pial surf<span class="o">)</span>
    22. Smooth2
    23. Inflate2

    24. Spherical Mapping
    25. Spherical Registration
    26. Spherical Registration, Contralater hemisphere
    27. Map average curvature to subject
    28. Cortical Parcellation <span class="o">(</span>Labeling<span class="o">)</span>
    29. Cortical Parcellation Statistics
    30. Pial Surfs
    31. WM/GM Contrast
    32. Cortical Ribbon Mask
    33. Cortical Parcellation mapped to ASeg
    <span class="m">34</span>  Brodmann and exvio EC labels

 Step-wise Directives
  See -help

 Expert Preferences
  -pons-crs C R S : col, row, slice of seed point <span class="k">for</span> pons, used in fill
  -cc-crs C R S : col, row, slice of seed point <span class="k">for</span> corpus callosum, used in fill
  -lh-crs C R S : col, row, slice of seed point <span class="k">for</span> left hemisphere, used in fill
  -rh-crs C R S : col, row, slice of seed point <span class="k">for</span> right hemisphere, used in fill
  -nofill        : <span class="k">do</span> not use the automatic subcort seg to fill
  -watershed cmd : control skull stripping/watershed program
  -wsless : decrease watershed threshold <span class="o">(</span>leaves less skull, but can strip more brain<span class="o">)</span>
  -wsmore : increase watershed threshold <span class="o">(</span>leaves more skull, but can strip less brain<span class="o">)</span>
  -wsatlas : use atlas when skull stripping
  -no-wsatlas : <span class="k">do</span> not use atlas when skull stripping
  -no-wsgcaatlas : <span class="k">do</span> not use GCA atlas when skull stripping
  -wsthresh pct : explicity <span class="nb">set </span>watershed threshold
  -wsseed C R S : identify an index <span class="o">(</span>C, R, S<span class="o">)</span> point in the skull
  -nuiterations N : <span class="nb">set </span>number of iterations <span class="k">for</span> nu intensity
                    correction <span class="o">(</span>default is 2<span class="o">)</span>
  -norm3diters niters : number of 3d iterations <span class="k">for</span> mri_normalize
  -normmaxgrad maxgrad : max grad <span class="o">(</span>-g<span class="o">)</span> <span class="k">for</span> mri_normalize. Default is 1.
  -norm1-b N : in the _first_ usage of mri_normalize, use control
               point with intensity N below target <span class="o">(</span><span class="nv">default</span><span class="o">=</span>10.0<span class="o">)</span>
  -norm2-b N : in the _second_ usage of mri_normalize, use control
               point with intensity N below target <span class="o">(</span><span class="nv">default</span><span class="o">=</span>10.0<span class="o">)</span>
  -norm1-n N : in the _first_ usage of mri_normalize, <span class="k">do</span> N number
               of iterations
  -norm2-n N : in the _second_ usage of mri_normalize, <span class="k">do</span> N number
               of iterations
  -cm           : conform volumes to the min voxel size
  -no-fix-with-ga : <span class="k">do</span> not use genetic algorithm when fixing topology
  -fix-diag-only  : topology fixer runs <span class="k">until</span> ?h.defect_labels files
                    are created, <span class="k">then</span> stops
  -seg-wlo wlo : <span class="nb">set </span>wlo value <span class="k">for</span> mri_segment and mris_make_surfaces
  -seg-ghi ghi : <span class="nb">set </span>ghi value <span class="k">for</span> mri_segment and mris_make_surfaces
  -nothicken   : pass <span class="s1">&#39;-thicken 0&#39;</span> to mri_segment
  -no-ca-align-after : turn off -align-after with mri_ca_register
  -no-ca-align : turn off -align with mri_ca_label
  -deface      : deface subject, written to orig_defaced.mgz

  -expert file     : <span class="nb">read</span>-in expert options file
  -xopts-use       : use pre-existing expert options file
  -xopts-clean     : delete pre-existing expert options file
  -xopts-overwrite : overwrite pre-existing expert options file

  -mprage : assume scan parameters are MGH MP-RAGE protocol
  -washu_mprage : assume scan parameters are Wash.U. MP-RAGE protocol.
                  both mprage flags affect mri_normalize and mri_segment,
                  and assumes a darker gm.

  -use-gpu : use GPU versions of mri_em_register, mri_ca_register,
             mris_inflate and mris_sphere

 Notification Files <span class="o">(</span>Optional<span class="o">)</span>
  -waitfor file : <span class="nb">wait </span><span class="k">for</span> file to appear before beginning
  -notify  file : create this file after finishing

 Status and Log files <span class="o">(</span>Optional<span class="o">)</span>
  -log     file : default is scripts/recon-all.log
  -status  file : default is scripts/recon-all-status.log
  -noappend     : start new log and status files instead of appending
  -no-isrunning : <span class="k">do</span> not check whether this subject is currently being processed

 Other Arguments <span class="o">(</span>Optional<span class="o">)</span>
  -sd subjectsdir : specify subjects dir <span class="o">(</span>default env SUBJECTS_DIR<span class="o">)</span>
  -mail username  : mail user when <span class="k">done</span>
  -umask <span class="nb">umask</span>    : <span class="nb">set </span>unix file permission mask <span class="o">(</span>default 002<span class="o">)</span>
  -grp groupid    : check that current group is alpha groupid
  -onlyversions   : print version of each binary and <span class="nb">exit</span>
  -debug          : print out lots of info
  -allowcoredump  : <span class="nb">set </span>coredump limit to unlimited
  -dontrun        : <span class="k">do</span> everything but execute each <span class="nb">command</span>
  -version        : print version of this script and <span class="nb">exit</span>
  -help           : voluminous bits of wisdom</code></pre></div>


            
        </section>

        <footer>
            <address>
               <img src="/images/naomi.jpg">
                <p>Written by <strong><a rel="author" href="https://twitter.com/" title="" target="_blank">Naomi J. Goodrich-Hunsaker</a></strong><br>
                <span class="muted">Website Manager</span>
                </p>
            </address>

        </footer>

        
        <section>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'biabl'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
        </section>
        
    </div>
</article>

    <footer class="site-footer">
        <div class="container">
            &copy; 2015
            <nav>
                <a href="http://biabl.github.io">Brain Imaging and Behavior Lab</a>
            </nav>
            <nav class="social">
                 
                 
                <a href="/feed.xml" title="RSS Feed"><i class="icon icon-rss black"></i></a>
            </nav>
        </div>
    </footer>
    
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js" defer></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" defer></script>
  <script src="dist/js/bootstrap-submenu.min.js" defer></script>
  <style type="text/css">
<script src="/assets/main.js"></script>







</body>
</html>