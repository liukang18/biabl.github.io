
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Types of Morphometry Analyses</title>
    
    <meta name="author" content="Naomi Goodrich-Hunsaker, Ph.D.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/assets/themes/bootstrap/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/themes/bootstrap/css/pygments.css">
  
    <!--[if lt IE 9]>
      <script src="/assets/themes/bootstrap/resources/respond/Respond.min.js"></script>
    <![endif]-->

    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Brain Imaging and Behavior Lab</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
          <li><a href="/tutorials">Tutorials </a></li>
          <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Projects <span class="caret"></span></a>
          <ul class="dropdown-menu">
          	<li class="dropdown-header">SOBIK</li>
            <li><a href="/projects/SOBIK/template/">Template</a></li>
            <li role="separator" class="divider"></li>
            <li class="dropdown-header">MIOS</li>
            <li><a href="/projects/MIOS/corpus-callosum">Corpus Callosum</a></li>
          </ul>
        </li>
        <li>  </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
    <div class="container">
      

<div class="page-header">
  <h1>Types of Morphometry Analyses </h1>
</div>

    <div class="row">
        <div class="col-sm-3">
            <div class="sidebar-nav">
                <div class="navbar navbar-default" role="navigation">
                    <div class="navbar-header">
                        <button class="navbar-toggle" data-target=".sidebar-navbar-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <span class="visible-xs navbar-brand">Sidebar menu</span>
                    </div>
                    <div class="navbar-collapse collapse sidebar-navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">General Topics <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                   <li><a href="/tutorials/general/unix-cheat-sheet/">Unix Cheat Sheet</a></li>
                                    <li><a href="/tutorials/general/introduction-to-fulton-supercomputer-lab/">Introduction to Fulton Supercomputer</a></li>
                                    <li><a href="/tutorials/general/submitting-jobs/">Submitting Batch Jobs on Supercomputer</a></li>
                                    <li><a href="/tutorials/general/R/">Learn R</a></li>
                                    <li><a href="/tutorials/general/install-freesurfer/">How to Install Freesurfer on Supercomputer</a></li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">Structural Imaging <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a href="/tutorials/structural/preprocessing_T1_weighted_images/">Preprocessing T1 Weighted Images</a></li>
                                    <li><a href="/tutorials/structural/convert-to-nifti/">Other Ways to Convert to NIfTI</a></li>
                                    <li><a href="/tutorials/structural/normalization/">Normalization</a></li>
                                    <li><a href="/tutorials/structural/cortical_thickness/">Tissue Segmentation and Cortical Thickness</a></li>
                                    <li><a href="/tutorials/structural/morphometry/">Various Morphometry Analyses</a></li>
                                    <li><a href="/tutorials/structural/ANTsR/">ANTsR</a></li>
                                    <li><a href="/tutorials/structural/group_average/">Group Average Overlays with ANTsR</a></li>
                                    <li><a href="/tutorials/structural/roi/">ROI Analysis with DKT</a></li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">Diffusion Imaging <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a href="/tutorials/diffusion/preprocessing_diffusion_weighted_images/">Preprocessing Diffusion Weighted Images</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>
        <div class="col-sm-9">
 <h2 id="objectives">Objectives</h2>

<p>After you complete this section, you should be able to:</p>

<ol>
  <li>Describe tensor based morphometry</li>
  <li>Know what image is used in TBM</li>
  <li>Describe voxel based morphometry</li>
  <li>Know how to generate the image used in VBM</li>
</ol>

<p>Note that everything in “&lt; &gt;” is to be replaced. For example, &lt;fileName&gt; –&gt; iLovePeanuts.txt</p>

<h2 id="tensor-based-morphometry">Tensor Based Morphometry</h2>

<p>Tensor based morphometry measures the differences in shape of brain structures. Analyses are useful in studies interested in whether growth or volume loss has occurred. This analysis is also useful in detecting small changes in longitudinal studies.</p>

<p>The warp field only represents positions of brain structures and not local shape information. Instead, the Jacobian determinant contains information about the local stretching, shearing and rotation involved in the deformation.</p>

<h3 id="fixed-image">Fixed Image</h3>

<div class="row">
    <div class="col-xs-6">
		<img class="img-responsive" alt="" src="images/fixed.jpg" />
	</div>
	<div class="col-xs-6">
		<img class="img-responsive" alt="" src="images/moving.jpg" />
	</div>
</div>

<p><img class="img-responsive" alt="" src="images/logjac.png" /></p>

<p>Taking the log of the Jacobian makes it symmetric about zero. Positive values indicate tissue enlargement, whereas negative values indicate tissue reduction in the participant as compared to the template.</p>

<h3 id="group-analysis">Group Analysis</h3>

<p>In order to complete group analyses, all images have to be template space so you know you are comparing apples to apples. For group analyses, images cannot be in native, participant space.</p>

<p>The log Jacobian image is used for analyses. Running antsCorticalThickness pipeline will automatically generate the log Jacobian (i.e., <em>SubjectToTemplateLogJacobian.nii.gz</em>).</p>

<h2 id="voxel-based-morphometry">Voxel Based Morphometry</h2>

<p>Voxel Based Morphometry measures structural differences in tissue classes (e.g., gray matter atrophy). Analyses are useful in studies interested in tissue specific volumetric differences.</p>

<p>The normalized images are adjusted by scaling the intensity of each voxel by the log jacobian. In other words the volume changes due to the non-linear spatial normalization are used to <em>modulate</em> the normalized image. Otherwise your analysis will give you null results because all the images look exactly alike (that’s the point of normalizing to a template).</p>

<p><img class="img-responsive" alt="" src="images/workflow.png" /></p>

<h3 id="group-analysis-1">Group Analysis</h3>

<p>The modulated normalized gray matter image is used for analyses. This image has to be self generated.</p>

<h2 id="modulate-gray-matter-image">Modulate Gray Matter Image</h2>

<p>First, you will take the template GM ROI and multiply it with the normalization whole brain image. Remember the value inside the ROI is 1 and the value outside the ROI is 0. When you multiply anything by 0 it equals 0, so when you multiply these two images together, you are left with just normalized gray matter.</p>

<div class="row">
    <div class="col-xs-6">
		<img class="img-responsive" alt="" src="images/brain.png" />
	</div>
	<div class="col-xs-6">
		<img class="img-responsive" alt="" src="images/roi.png" />
	</div>
</div>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">SUBJ_DIR</span><span class="o">=</span>~/path/to/subject/directory
<span class="nv">TEMPLATE_DIR</span><span class="o">=</span>~/path/to/template/directory/
c3d <span class="se">\</span>
<span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/BrainNormalizedToTemplate.nii.gz <span class="se">\</span>
<span class="k">${</span><span class="nv">TEMPLATE_DIR</span><span class="k">}</span>/T_template0_gm.nii.gz <span class="se">\</span>
-multiply <span class="se">\</span>
-o <span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/GMSegmented.nii.gz</code></pre></figure>

<p><img class="img-responsive" alt="" src="images/segmented.png" /></p>

<p>The image has been normalized to a template, so at this point the image should be nearly indistinguishable from the template. Any comparison will result in null results. However, if you multiply the image by the log Jacobian, then you are adjusting the intensity of each gray matter voxel by the amount of stretching, shearing, and rotation that occurred.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">c3d <span class="se">\</span>
<span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/GMSegmented.nii.gz <span class="se">\</span>
<span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/SubjectToTemplateLogJacobian.nii.gz <span class="se">\</span>
-multiply <span class="se">\</span>
-o <span class="k">${</span><span class="nv">SUBJ_DIR</span><span class="k">}</span>/corticalthickness/GMModulated.nii.gz</code></pre></figure>

<p><img class="img-responsive" alt="" src="images/modulated.png" /></p>

<h3 id="additional-classroom-materials">Additional Classroom Materials</h3>

<ul>
  <li><a href="presentation">Lecture</a></li>
  <li><a href="assignment">Assignment</a></li>
</ul>

        </div>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




      <hr>
      <footer>
        <p>
          &copy; 2015 Naomi Goodrich-Hunsaker, Ph.D.
          <span class="pull-right text-muted">
            powered by
            <a href="http://dbtek.github.io/jekyll-bootstrap-3" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll-Bootstrap-3</a>
            and <a href="http://getbootstrap.com" target="_blank">Twitter Bootstrap 3.0.3</a>
          </span>
        </p>
      </footer>
    </div>

    

    <script src="/assets/themes/bootstrap/resources/jquery/jquery.min.js"></script>
    <script src="/assets/themes/bootstrap/resources/bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>

