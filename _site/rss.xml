<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
<channel>
        <title>Brain Imaging and Behavior Lab</title>
        <description>Brain Imaging and Behavior Lab - Naomi Goodrich-Hunsaker, Ph.D.</description>
        <link>http://biabl.github.io/</link>
        <link>http://biabl.github.io/</link>
        <lastBuildDate>2016-02-16T12:27:34-07:00</lastBuildDate>
        <pubDate>2016-02-16T12:27:34-07:00</pubDate>
        <ttl>1800</ttl>


        <item>
                <title>Improved antsRegistrationSynQuick.sh</title>
                <description>&lt;p&gt;Given our dataset, improvement of antsRegistrationSynQuick.sh was needed. Particularly when other scripts all antsRegistrationSynQuick.sh (e.g., antsJointLabelFusion.sh). The old antsRegistrationSynQuick.sh code was as follows:&lt;/p&gt;

&lt;!-- more --&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;##############################&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Construct mapping stages&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;##############################&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;RIGIDCONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[1000x500x250x0,1e-6,10]&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;RIGIDSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;8x4x2x1&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;RIGIDSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;3x2x1x0vox&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;AFFINECONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[1000x500x250x0,1e-6,10]&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;AFFINESHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;8x4x2x1&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;AFFINESMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;3x2x1x0vox&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;SYNCONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[100x70x50x0,1e-6,10]&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SYNSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;8x4x2x1&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SYNSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;3x2x1x0vox&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ISLARGEIMAGE&lt;/span&gt; -eq 1 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;;
  &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;RIGIDCONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[1000x500x250x0,1e-6,10]&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;RIGIDSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;12x8x4x2&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;RIGIDSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4x3x2x1vox&quot;&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;AFFINECONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[1000x500x250x0,1e-6,10]&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;AFFINESHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;12x8x4x2&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;AFFINESMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4x3x2x1vox&quot;&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;SYNCONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[100x100x70x50x0,1e-6,10]&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;SYNSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;10x6x4x2x1&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;SYNSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;5x3x2x1x0vox&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;tx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Rigid
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$TRANSFORMTYPE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;t&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt; ; &lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;tx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Translation
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;RIGIDSTAGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;--initial-moving-transform [&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MOVINGIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,1] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --transform &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;tx&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;[0.1] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --metric MI[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MOVINGIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,1,32,Regular,0.25] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --convergence &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RIGIDCONVERGENCE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --shrink-factors &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RIGIDSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --smoothing-sigmas &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RIGIDSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;AFFINESTAGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;--transform Affine[0.1] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
             --metric MI[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MOVINGIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,1,32,Regular,0.25] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
             --convergence &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AFFINECONVERGENCE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
             --shrink-factors &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AFFINESHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
             --smoothing-sigmas &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AFFINESMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;SYNMETRICS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0; i&amp;lt;&lt;span class=&quot;k&quot;&gt;${#&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[@]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;; i++ &lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SYNMETRICS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SYNMETRICS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; --metric MI[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MOVINGIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,1,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NUMBEROFBINS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;]&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;done

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SYNSTAGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SYNMETRICS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
          --convergence &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SYNCONVERGENCE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
          --shrink-factors &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SYNSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
          --smoothing-sigmas &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SYNSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The new parameters are as follows:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;##############################&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Construct mapping stages&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;##############################&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;RIGIDCONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[1000x500x250x0,1e-6,10]&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;RIGIDSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;6x4x2x1&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;RIGIDSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4x2x1x0vox&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;AFFINECONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[1000x500x250x0,1e-6,10]&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;AFFINESHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;6x4x2x1&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;AFFINESMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4x2x1x0vox&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;SYNCONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[100x100x70x20,1e-10,10]&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SYNSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;6x4x2x1&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SYNSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;3x2x1x0vox&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ISLARGEIMAGE&lt;/span&gt; -eq 1 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;;
  &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;RIGIDCONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[1000x500x250x0,1e-6,10]&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;RIGIDSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;12x8x4x2&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;RIGIDSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4x3x2x1vox&quot;&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;AFFINECONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[1000x500x250x0,1e-6,10]&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;AFFINESHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;12x8x4x2&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;AFFINESMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;4x3x2x1vox&quot;&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;SYNCONVERGENCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[100x100x70x50x0,1e-10,10]&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;SYNSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;10x6x4x2x1&quot;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;SYNSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;5x3x2x1x0vox&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;tx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Rigid
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$TRANSFORMTYPE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;t&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt; ; &lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;tx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Translation
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;RIGIDSTAGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;--initial-moving-transform [&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MOVINGIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,1] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --transform &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;tx&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;[0.1] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --metric MI[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MOVINGIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,1,32,Regular,0.25] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --convergence &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RIGIDCONVERGENCE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --shrink-factors &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RIGIDSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
            --smoothing-sigmas &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RIGIDSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;AFFINESTAGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;--transform Affine[0.1] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
             --metric MI[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MOVINGIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[0]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,1,32,Regular,0.25] &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
             --convergence &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AFFINECONVERGENCE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
             --shrink-factors &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AFFINESHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
             --smoothing-sigmas &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AFFINESMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;SYNMETRICS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0; i&amp;lt;&lt;span class=&quot;k&quot;&gt;${#&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[@]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;; i++ &lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SYNMETRICS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SYNMETRICS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; --metric CC[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FIXEDIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MOVINGIMAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;,1,4]&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;done

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SYNSTAGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SYNMETRICS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
          --convergence &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SYNCONVERGENCE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
          --shrink-factors &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SYNSHRINKFACTORS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
          --smoothing-sigmas &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SYNSMOOTHINGSIGMAS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Further testing is needed to evaluate when large lesions are present.&lt;/p&gt;
</description>
                <link>http://biabl.github.io//2016/01/14/improved-antsRegistrationSynQuick</link>
                <guid>http://biabl.github.io//2016/01/14/improved-antsRegistrationSynQuick</guid>
                <pubDate>2016-01-14T00:00:00-07:00</pubDate>
        </item>

        <item>
                <title>Optimizing ANTs Joint Label Fusion</title>
                <description>&lt;p&gt;Ran into a problem or two, but mostly it was about optimizing the pipeline.&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Here’s the final code I used to run the SOBIK template:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;TEMPLATE_DIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/fslhome/intj5/templates/OASIS-TRT-20_volumes
&lt;span class=&quot;nv&quot;&gt;LABEL_DIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/fslhome/intj5/templates/OASIS-TRT-20_DKT31_CMA_labels_v2
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /fslhome/intj5/compute/templates/SOBIK
mkdir labels
&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ANTSPATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/antsJointLabelFusion.sh &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-d 3 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-c 5 -j 2 -y s -k 1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-o /fslhome/intj5/compute/templates/SOBIK/labels/ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-p /fslhome/intj5/compute/templates/SOBIK/labels/Posteriors%02d.nii.gz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-t /fslhome/intj5/compute/templates/SOBIK/data/sobikbraintemplate.nii.gz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-g &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TEMPLATE_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-1/t1weighted_brain.nii.gz -l &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LABEL_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-1_DKT31_CMA_labels.nii.gz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-g &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TEMPLATE_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-2/t1weighted_brain.nii.gz -l &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LABEL_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-2_DKT31_CMA_labels.nii.gz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-g &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TEMPLATE_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-3/t1weighted_brain.nii.gz -l &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LABEL_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-3_DKT31_CMA_labels.nii.gz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-g &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TEMPLATE_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-4/t1weighted_brain.nii.gz -l &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LABEL_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-4_DKT31_CMA_labels.nii.gz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-g &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TEMPLATE_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-5/t1weighted_brain.nii.gz -l &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LABEL_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-5_DKT31_CMA_labels.nii.gz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-g &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TEMPLATE_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-6/t1weighted_brain.nii.gz -l &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LABEL_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/OASIS-TRT-20-6_DKT31_CMA_labels.nii.gz&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;problem-1&quot;&gt;Problem 1&lt;/h2&gt;

&lt;p&gt;My code wouldn’t run if I didn’t specifically state my transformation type is &lt;code class=&quot;highlighter-rouge&quot;&gt;-y s&lt;/code&gt;, even though that’s the default. Make sure to add that option to your code.&lt;/p&gt;

&lt;h2 id=&quot;problem-2&quot;&gt;Problem 2&lt;/h2&gt;

&lt;p&gt;The generated &lt;code class=&quot;highlighter-rouge&quot;&gt;job_t1weighted_0.sh&lt;/code&gt; file contained the wrong code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/sh&lt;/span&gt;
/fslhome/intj5/apps/ants-20151207/bin//antsRegistrationSyNQuick.sh -d 3 -p d -j 1 -t s -f /fslhome/intj5/compute/templates/SOBIK/data/sobiktemplate.nii.gz -m /fslhome/intj5/templates/OASIS-TRT-20_volumes/OASIS-TRT-20-1/t1weighted.nii.gz -o /fslhome/intj5/compute/templates/SOBIK/labels/t1weighted_0_ &amp;gt; /fslhome/intj5/compute/templates/SOBIK/labels/t1weighted_0_log.txt
/fslhome/intj5/apps/ants-20151207/bin//antsApplyTransforms -d 3 --float 1                           -i /fslhome/intj5/templates/OASIS-TRT-20_volumes/OASIS-TRT-20-1/labels.DKT25.manual.nii.gz -r /fslhome/intj5/compute/templates/SOBIK/data/sobiktemplate.nii.gz -o /fslhome/intj5/compute/templates/SOBIK/labels/t1weighted_0_WarpedLabels.nii.gz -n NearestNeighbor                           -t /fslhome/intj5/compute/templates/SOBIK/labels/t1weighted_0_0Warp.nii.gz &amp;gt;&amp;gt; /fslhome/intj5/compute/templates/SOBIK/labels/t1weighted_0_log.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The error is that when you run antsRegistrationSynQuick.sh, the output warp file should be &lt;em&gt;t1weighted_0_1Warp.nii.gz&lt;/em&gt; and not &lt;em&gt;t1weighted_0_0Warp.nii.gz&lt;/em&gt;, so when it’s trying to run antsApplyTransforms, it can’t find the files. Moreover the affine.mat file is also required.&lt;/p&gt;

&lt;p&gt;I simply commented out the offending lines (532 - 542) in the antsJointLabelFusion.sh script:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#     if [[ ! -f &quot;${OUTPUT_PREFIX}${BASENAME}_${i}_0GenericAffine.mat&quot; ]];&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#       then&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#         labelXfrmCall=&quot;${ANTSPATH}/antsApplyTransforms \&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#                               -d ${DIM} \&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#                               --float 1 \&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#                               -i ${ATLAS_LABELS[$i]} \&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#                               -r ${TARGET_IMAGE} \&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#                               -o ${OUTPUT_PREFIX}${BASENAME}_${i}_WarpedLabels.nii.gz \&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#                               -n NearestNeighbor \&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#                               -t ${OUTPUT_PREFIX}${BASENAME}_${i}_0Warp.nii.gz &amp;gt;&amp;gt; ${OUTPUT_PREFIX}${BASENAME}_${i}_log.txt&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#       fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;problem-3&quot;&gt;Problem 3&lt;/h2&gt;

&lt;p&gt;Throughout the antsJointLabelFusion.sh code, the slurm memory limit is set to 8GB, which is too low. The supercomputer will not complete the code with so few resources. I went through the script and changed everything to &lt;code class=&quot;highlighter-rouge&quot;&gt;--mem-per-cpu=32768M&lt;/code&gt;. So far no problems completing the code with the memory set this high.&lt;/p&gt;

&lt;h2 id=&quot;problem-4&quot;&gt;Problem 4&lt;/h2&gt;

&lt;p&gt;I was originally trying to run my template which was 1x0.5x0.5 voxels. This was NOT going to run the final step. Make sure your target image is at least 1 isotropic.&lt;/p&gt;

&lt;h2 id=&quot;problem-5--6&quot;&gt;Problem 5 &amp;amp; 6&lt;/h2&gt;

&lt;p&gt;Brain extracted image versus whole brain. I first ran with a target image that was not skull stripped. The first step of registering each labeled image to the target image resulted in bad registration. I tried to solve this problem by adding the option &lt;code class=&quot;highlighter-rouge&quot;&gt;-x&lt;/code&gt; to include a target mask image. The initial registration was STILL awful, and instead of labeling the brain included in the mask, JLF only labeled the sparse few brain voxels that snuck outside the mask?!&lt;/p&gt;

&lt;p&gt;The final solution was to make sure the target and label images were all skull stripped and no target mask image was included.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/media/sagittal0050.png&quot; alt=&quot;sagittal0050.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0060.png&quot; alt=&quot;sagittal0060.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0070.png&quot; alt=&quot;sagittal0070.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0080.png&quot; alt=&quot;sagittal0080.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0090.png&quot; alt=&quot;sagittal0090.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0100.png&quot; alt=&quot;sagittal0100.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0110.png&quot; alt=&quot;sagittal0110.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0120.png&quot; alt=&quot;sagittal0120.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0130.png&quot; alt=&quot;sagittal0130.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0140.png&quot; alt=&quot;sagittal0140.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0150.png&quot; alt=&quot;sagittal0150.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0160.png&quot; alt=&quot;sagittal0160.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0170.png&quot; alt=&quot;sagittal0170.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0180.png&quot; alt=&quot;sagittal0180.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0190.png&quot; alt=&quot;sagittal0190.png&quot; class=&quot;img-responsive&quot; /&gt;
&lt;img src=&quot;/media/sagittal0200.png&quot; alt=&quot;sagittal0200.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;
</description>
                <link>http://biabl.github.io//2015/12/14/optimzing-ANTs-JLF</link>
                <guid>http://biabl.github.io//2015/12/14/optimzing-ANTs-JLF</guid>
                <pubDate>2015-12-14T00:00:00-07:00</pubDate>
        </item>

        <item>
                <title>buildtemplateparallel.sh Bug</title>
                <description>&lt;p&gt;When trying to run buildtemplateparallel.sh, I ran into several problems. Here are a list of changes I had to make. Here’s my code to run buildtemplateparallel.sh:&lt;/p&gt;

&lt;!-- more --&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /fslhome/intj5/compute/templates/SOBIK/data
~/apps/ants-20151207/bin/buildtemplateparallel.sh &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-d 3 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-o sobik &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-c 5 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.nii.gz&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;problem-1&quot;&gt;Problem 1&lt;/h2&gt;

&lt;p&gt;There was not a &lt;em&gt;qscript&lt;/em&gt; variable after the &lt;code class=&quot;highlighter-rouge&quot;&gt;elif&lt;/code&gt; command on line 1237.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$DOQSUB&lt;/span&gt; -eq 5 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then
      &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;qscript&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;job_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.sh&quot;&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;#!/bin/sh&quot;&lt;/span&gt; &amp;gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;qscript&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;problem-2&quot;&gt;Problem 2&lt;/h2&gt;

&lt;p&gt;Next issue was the lack of specifying the amount of memory required for the sbatch submission. The FSL supercomputer requires memory listed, &lt;code class=&quot;highlighter-rouge&quot;&gt;--mem-per-cpu=32768M&lt;/code&gt;. Here’s how I fixed the code on line 1242 (previously 1241 before fixing Problem #1).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;sbatch --job-name&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;antsdef&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; --export&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ITK_GLOBAL_DEFAULT_NUMBER_OF_THREADS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1,LD_LIBRARY_PATH&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LD_LIBRARY_PATH&lt;/span&gt;,ANTSPATH&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ANTSPATH&lt;/span&gt; --nodes&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 --cpus-per-task&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 --mem-per-cpu&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;32768M --time&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;50:00:00 &lt;span class=&quot;nv&quot;&gt;$QSUBOPTS&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$qscript&lt;/span&gt; | rev | cut -f1 -d&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;| rev&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;problem-3&quot;&gt;Problem 3&lt;/h2&gt;

&lt;p&gt;The latest version of &lt;code class=&quot;highlighter-rouge&quot;&gt;N4BiasFieldCorrection&lt;/code&gt; was giving errors and aborting script. I was able to copy the script from the pre-complied code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cp -v &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
~/apps/ants-2.1.0-redhat/N4BiasFieldCorrection &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
~/apps/ants-20151207/bin/N4BiasFieldCorrection&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here’s the end result of using the 20 SOBIK participants. Goosebumps!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/media/sobiktemplate.jpg&quot; alt=&quot;sobiktemplate.jpg&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

</description>
                <link>http://biabl.github.io//2015/12/08/buildtemplateparallel.sh-bug</link>
                <guid>http://biabl.github.io//2015/12/08/buildtemplateparallel.sh-bug</guid>
                <pubDate>2015-12-08T00:00:00-07:00</pubDate>
        </item>

        <item>
                <title>ANTs Installation Bug</title>
                <description>&lt;p&gt;There’s a bug with how GCC is installed on the supercomputer, which prevents installation of ANTs. Luckily there’s a solution.&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Make sure you start with a completely fresh install. Remove the &lt;code class=&quot;highlighter-rouge&quot;&gt;ANTs&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;antsbin&lt;/code&gt; directories:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/apps/
rm -rf ANTs
rm -rf antsbin&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Follow the directions provided by ANTs:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/apps/
git clone git://github.com/stnava/ANTs.git
mkdir ants-20151207
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;ants-20151207
ccmake ../ANTs&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In CMAKE, type “c” to load the configuration information and then type “t” to toggle to advanced mode. You want to edit the option, “CMAKE_EXE_LINKER_FLAGS” which by default is blank, but needs to be &lt;code class=&quot;highlighter-rouge&quot;&gt;-fuse-ld=bfd&lt;/code&gt; instead. Press “ENTER” to edit the option.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2015-12-07-ants-installation-bug/screenshot-image1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Type “c” and then “g” and then exit back to the terminal by typing “q”.&lt;/p&gt;

&lt;p&gt;Compile your code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;make -j 4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;and wait awhile.&lt;/p&gt;

&lt;p&gt;Once ANTs is installed, remember to copy the scripts to your ANTs bin directory and set your environmental variables:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cp -v ~/apps/ANTs/Scripts/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; ~/apps/ants-20151207/bin/
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;export ANTSPATH=/fslhome/&amp;lt;USERNAME&amp;gt;/antsbin-20151207/bin/&quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.bash_profile
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;export PATH=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ANTSPATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.bash_profile&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
                <link>http://biabl.github.io//2015/12/07/ants-installation-bug</link>
                <guid>http://biabl.github.io//2015/12/07/ants-installation-bug</guid>
                <pubDate>2015-12-07T00:00:00-07:00</pubDate>
        </item>

        <item>
                <title>Average Cortical Thickness Consideration</title>
                <description>&lt;p&gt;If you were to just take the average of all the voxels in the cortical thickness image, you would be including a lot of extra non-cortical voxels that will GREATLY skew your data!&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;In order to deal with this issue, if you use the gray matter segmentation as a mask, then when you acquire the average thickness, it will be for the cortical regions only. Remember the the human cortex ranges from about 1 to 4mm in thickness with an average around 2.5 to 3mm.&lt;/p&gt;

&lt;h2 id=&quot;generate-data&quot;&gt;Generate Data&lt;/h2&gt;

&lt;p&gt;In order to extract the average cortical thickness in a single participant:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /path/to/antsCorticalThickness/directory/
~/apps/c3d/bin/c3d BrainSegmentation.nii.gz -threshold 2 2 1 0 -as MASK CorticalThickness.nii.gz -push MASK -lstat&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let’s compare the output if we didn’t run this code, but ran the code to just get the average intensity of ALL the voxels:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;~/apps/c3d/bin/c3d CorticalThickness.nii.gz -info-full
Image &lt;span class=&quot;c&quot;&gt;#1:&lt;/span&gt;
  Image Dimensions   : &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;198, 236, 200]
  Bounding Box       : &lt;span class=&quot;o&quot;&gt;{[&lt;/span&gt;100.999 96.2826 -87.5596], &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;298.933 332.089 112.618]&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  Voxel Spacing      : &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0.999667, 0.99918, 1.00089]
  Intensity Range    : &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0, 10.4775]
  Mean Intensity     : 0.271343&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Obvious a cortical thickness of 0.271343 is not valid. With the correct code you can see that the average thickness is actually 4.09824 \( \pm \) 1.42453.&lt;/p&gt;

&lt;p&gt;If you want to try and run this specifically with our course dataset:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;subj &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;ls ~/compute/data/&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;do 
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;subjDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;~/compute/data/&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;subj&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$subj&lt;/span&gt; &amp;gt;&amp;gt; ~/compute/projects/corticalthickness/data.csv 
~/apps/c3d/bin/c3d &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;subjDir&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/antsCorticalThickness/BrainSegmentation.nii.gz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-threshold 2 2 1 0 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-as MASK &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;subjDir&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/antsCorticalThickness/CorticalThickness.nii.gz &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-push MASK &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
-label-statistics &amp;gt;&amp;gt; ~/compute/projects/corticalthickness/data.csv
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;regular-expressions&quot;&gt;Regular Expressions&lt;/h2&gt;

&lt;p&gt;The file is not perfectly formatted so that it can be easily imported into R or even useful in Excel. Some editing of the file needs to happen and we can use the power of Regular Expressions in Terminal to edit the file. Just make sure to change the username in the first line of the code.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/fslhome/username/compute/projects/corticalthickness/data.csv&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%.*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;_modified.csv&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;dirname &lt;span class=&quot;nv&quot;&gt;$input&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
grep -vwE &lt;span class=&quot;s2&quot;&gt;&quot;(Reading #1|LabelID|^(    0))&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; | sed -e &lt;span class=&quot;s2&quot;&gt;&quot;s|/|,|&quot;&lt;/span&gt; -Ee &lt;span class=&quot;s2&quot;&gt;&quot;s/[ ]+/,/g&quot;&lt;/span&gt; &amp;gt; temp.txt
awk &lt;span class=&quot;s1&quot;&gt;&#39;/^[0-9][0-9][0-9][0-9]_[0-9][0-9][0-9][0-9][0-9][0-9]/{for(i=0;i&amp;lt;1;i++)print}&#39;&lt;/span&gt; temp.txt &amp;gt; part1.txt
awk &lt;span class=&quot;s1&quot;&gt;&#39;/^,/{print}&#39;&lt;/span&gt; temp.txt &amp;gt; part2.txt
sed -i &lt;span class=&quot;s1&quot;&gt;&#39;&#39;&lt;/span&gt; -e &lt;span class=&quot;s2&quot;&gt;&quot;s|,1,|,corticalthickness,|&quot;&lt;/span&gt; part2.txt 
paste part1.txt part2.txt &amp;gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
perl -pi -e &lt;span class=&quot;s1&quot;&gt;&#39;print &quot;subjectid, label, mean, std, max, min, count, volume (mm^3), extent x, extent y, extent z\n&quot; if($.==1)&#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
rm part1.txt
rm part2.txt
rm temp.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Note this code works for the SOBIK dataset. If you have different subject IDs, you’ll need to edit the regular expression in line #5. If you need more help figuring out regular expressions visit this website here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://regex101.com/&quot;&gt;https://regex101.com/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Happy Coding!&lt;/p&gt;
</description>
                <link>http://biabl.github.io//2015/12/06/average-cortical-thickness</link>
                <guid>http://biabl.github.io//2015/12/06/average-cortical-thickness</guid>
                <pubDate>2015-12-06T00:00:00-07:00</pubDate>
        </item>

        <item>
                <title>Oh noes, acpcdetect Failed!</title>
                <description>&lt;p&gt;Occasionally, &lt;em&gt;acpcdetect&lt;/em&gt; might not accurately find and adjust the images along the anterior and posterior commissure.  This can happen if there’s a lot of damage in the brain and the ventricles are enlarged. There are several things you can do to help &lt;em&gt;acpcdetect&lt;/em&gt;.&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h2 id=&quot;adjust-search-radius&quot;&gt;Adjust Search Radius&lt;/h2&gt;

&lt;p&gt;By default the search radius for the VSPS is 50 mm. You can change this by adding the option &lt;code class=&quot;highlighter-rouge&quot;&gt;-rvsps &amp;lt;r&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The default search radii for the anterior and posterior commissure are 15 mm. You can change each of these by adding the options &lt;code class=&quot;highlighter-rouge&quot;&gt;-rac &amp;lt;r&amp;gt;&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;-rpc &amp;lt;r&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Adjusting the search radius does not always work though.&lt;/p&gt;

&lt;h2 id=&quot;specify-the-precise-location&quot;&gt;Specify the Precise Location&lt;/h2&gt;

&lt;p&gt;You can also just tell the program where VSPS, AC, and PC are exactly located. To tell &lt;em&gt;acpcdetect&lt;/em&gt; where the VSPS is located, add the following option: &lt;code class=&quot;highlighter-rouge&quot;&gt;-VSPS &amp;lt;x&amp;gt; &amp;lt;y&amp;gt; &amp;lt;z&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;The best program to use is ITK-Snap to determine coordinates.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/media/VSPS.png&quot; alt=&quot;VSPS.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;To specify the location of the anterior commissure: &lt;code class=&quot;highlighter-rouge&quot;&gt;-AC &amp;lt;x&amp;gt; &amp;lt;y&amp;gt; &amp;lt;z&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/media/AC.png&quot; alt=&quot;AC.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;To specify the location of the posterior commissure: &lt;code class=&quot;highlighter-rouge&quot;&gt;-PC &amp;lt;x&amp;gt; &amp;lt;y&amp;gt; &amp;lt;z&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/media/PC.png&quot; alt=&quot;PC.png&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;With these methods, you will be able to fix any problems with &lt;em&gt;acpcdetect&lt;/em&gt;.&lt;/p&gt;
</description>
                <link>http://biabl.github.io//2015/12/05/oh-no-acpcdetect-failed</link>
                <guid>http://biabl.github.io//2015/12/05/oh-no-acpcdetect-failed</guid>
                <pubDate>2015-12-05T00:00:00-07:00</pubDate>
        </item>


</channel>
</rss>
